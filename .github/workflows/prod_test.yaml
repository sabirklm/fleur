on:
  pull_request:
    branches:
      - prod1
  push:
    branches:
      - prod1

name: "automation test"
jobs:
  drive_android:
    runs-on: macos-latest
    timeout-minutes: 30
    strategy:
      matrix:
        api-level: [29]
        target: [playstore]
    steps:
      - uses: actions/checkout@v2
      - uses: actions/setup-java@v1
        with:
          java-version: '12.x'
      - uses: subosito/flutter-action@v1
        with:
          flutter-version: '3.16.9'
          channel: 'stable'
      

      # Run integration test
      - name: Run Flutter Driver tests
        uses: reactivecircus/android-emulator-runner@v2
        with:
          api-level: 29
          # arch: arm64-v8a
          # channel: stable
          target: google_apis
          # profile: pixel_6
          # avd-name: Test_Pixel6_Google_fhd_2
          # force-avd-creation: false
          # emulator-options: -no-window -gpu host -noaudio -no-boot-anim -camera-back none
          # disable-animations: true
          script: flutter drive --flavor prod --driver=test_driver/integration_test.dart --target=integration_test/app_open_test.dart
      # Update screenshot to artifact
      - name: Upload screenshots
        if: always()
        uses: actions/upload-artifact@v1
        with:
          name: screenshot
          path: ${{ matrix.path }}screenshots/




